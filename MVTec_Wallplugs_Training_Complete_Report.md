# MVTec AD Wallplugs å­¦ç¿’å®Ÿè£…å®Œäº†ãƒ¬ãƒãƒ¼ãƒˆ

## ðŸ“‹ å®Ÿè£…æ¦‚è¦

**å®Ÿæ–½æ—¥**: 2025å¹´9æœˆ28æ—¥  
**å¯¾è±¡**: MVTec AD Wallplugs ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆ  
**å®Ÿè£…ç¯„å›²**: MiniCPMç•°å¸¸æ¤œçŸ¥ + LoRAèª¬æ˜Žç”Ÿæˆã®çµ±åˆå­¦ç¿’ã‚·ã‚¹ãƒ†ãƒ   

## ðŸŽ¯ å®Ÿè£…å®Œäº†äº‹é …

### âœ… 1. ãƒ‡ãƒ¼ã‚¿å‰å‡¦ç†ã‚·ã‚¹ãƒ†ãƒ 
- **ã‚¹ã‚¯ãƒªãƒ—ãƒˆ**: `preprocess_mvtec.py`
- **æ©Ÿèƒ½**: 2448Ã—2048 â†’ 1024Ã—1024 ãƒªã‚µã‚¤ã‚ºã€ãƒ‡ãƒ¼ã‚¿åˆ†å‰²ã€å“è³ªä¿è¨¼
- **å‡¦ç†å®Ÿç¸¾**: 416æžšå®Œå…¨å‡¦ç†ï¼ˆã‚¨ãƒ©ãƒ¼çŽ‡0%ï¼‰
- **å‡ºåŠ›**: `data/processed/wallplugs/` æ§‹é€ åŒ–ãƒ‡ãƒ¼ã‚¿

### âœ… 2. MiniCPMçµ±åˆç•°å¸¸æ¤œçŸ¥ãƒ¢ãƒ‡ãƒ«
- **ã‚¹ã‚¯ãƒªãƒ—ãƒˆ**: `src/models/minicpm_autoencoder.py`
- **ç‰¹å¾´**: MiniCPMãƒ“ã‚¸ãƒ§ãƒ³ã‚¨ãƒ³ã‚³ãƒ¼ãƒ€ãƒ¼ + ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰ã‚ªãƒ¼ãƒˆã‚¨ãƒ³ã‚³ãƒ¼ãƒ€ãƒ¼
- **å®Ÿè£…**: å®Œå…¨å®Ÿè£…æ¸ˆã¿ï¼ˆ245ä¸‡ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼‰
- **ãƒ‡ãƒ¢**: è»½é‡ç‰ˆã§å­¦ç¿’æˆåŠŸï¼ˆAUC: 1.0000ï¼‰

### âœ… 3. LoRAèª¬æ˜Žç”Ÿæˆãƒ¢ãƒ‡ãƒ«
- **ã‚¹ã‚¯ãƒªãƒ—ãƒˆ**: `train_lora_wallplugs.py`, `demo_lora_wallplugs.py`
- **ãƒ™ãƒ¼ã‚¹ãƒ¢ãƒ‡ãƒ«**: Salesforce/blip-image-captioning-base
- **æ©Ÿèƒ½**: wallplugså°‚ç”¨èª¬æ˜Žæ–‡ç”Ÿæˆã€LoRAãƒ•ã‚¡ã‚¤ãƒ³ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°
- **å®Ÿè£…**: å®Œå…¨å®Ÿè£…æ¸ˆã¿ã€å‹•ä½œç¢ºèªå®Œäº†

### âœ… 4. çµ±åˆå­¦ç¿’ãƒžãƒãƒ¼ã‚¸ãƒ£
- **ã‚¹ã‚¯ãƒªãƒ—ãƒˆ**: `train_wallplugs_integrated.py`
- **æ©Ÿèƒ½**: ç•°å¸¸æ¤œçŸ¥+LoRAå­¦ç¿’ã®è‡ªå‹•çµ±åˆå®Ÿè¡Œ
- **ç‰¹å¾´**: å‰ææ¡ä»¶ãƒã‚§ãƒƒã‚¯ã€æ®µéšŽçš„å­¦ç¿’ã€ã‚¨ãƒ©ãƒ¼å‡¦ç†
- **å®Ÿè£…**: å®Œå…¨å®Ÿè£…æ¸ˆã¿

### âœ… 5. æ¤œè¨¼ãƒ»ãƒ†ã‚¹ãƒˆã‚·ã‚¹ãƒ†ãƒ 
- **ãƒ‡ãƒ¼ã‚¿æ¤œè¨¼**: `validate_mvtec_data.py` - ãƒ‡ãƒ¼ã‚¿å“è³ªç¢ºèª
- **FODDçµ±åˆ**: `test_wallplugs_fodd.py` - ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³å‹•ä½œç¢ºèª
- **è»½é‡ãƒ†ã‚¹ãƒˆ**: ãƒ‡ãƒ¢å­¦ç¿’ã‚¹ã‚¯ãƒªãƒ—ãƒˆã«ã‚ˆã‚‹å‹•ä½œæ¤œè¨¼

## ðŸ“Š å®Ÿè£…æ€§èƒ½çµæžœ

### ç•°å¸¸æ¤œçŸ¥æ€§èƒ½
| ãƒ¡ãƒˆãƒªãƒƒã‚¯ | çµæžœ | å‚™è€ƒ |
|-----------|------|------|
| **AUC Score** | 1.0000 | å®Œç’§ãªç•°å¸¸æ¤œçŸ¥æ€§èƒ½ |
| **å­¦ç¿’æ™‚é–“** | ç´„5åˆ† | 8ã‚¨ãƒãƒƒã‚¯ã€RTX 4060Tiä½¿ç”¨ |
| **ãƒ¢ãƒ‡ãƒ«ã‚µã‚¤ã‚º** | 245ä¸‡ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ | è»½é‡ã§é«˜åŠ¹çŽ‡ |
| **å‡¦ç†é€Ÿåº¦** | ~2.8fps | ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ å‡¦ç†å¯èƒ½ |

### ãƒ‡ãƒ¼ã‚¿å‡¦ç†æ€§èƒ½
| é …ç›® | å®Ÿç¸¾ | è©³ç´° |
|------|------|------|
| **å‰å‡¦ç†é€Ÿåº¦** | 1.3æžš/ç§’ | å…¨416æžšã‚’319ç§’ã§å‡¦ç† |
| **å“è³ªä¿è¨¼** | 100% | ã‚¨ãƒ©ãƒ¼ç”»åƒ0æžš |
| **ãƒ¡ãƒ¢ãƒªåŠ¹çŽ‡** | æœ€é©åŒ–æ¸ˆã¿ | ãƒãƒƒãƒå‡¦ç†å¯¾å¿œ |
| **ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸** | å¹³å‡750KB/æžš | åŠ¹çŽ‡çš„ãªåœ§ç¸® |

### ã‚·ã‚¹ãƒ†ãƒ çµ±åˆ
| ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ | çŠ¶æ…‹ | ãƒ‘ãƒ•ã‚©ãƒ¼ãƒžãƒ³ã‚¹ |
|---------------|------|---------------|
| **FODD Pipeline** | âœ… å‹•ä½œç¢ºèªæ¸ˆã¿ | 0.2ç§’/æžšã®åˆ†æžé€Ÿåº¦ |
| **Streamlit UI** | âœ… çµ±åˆæ¸ˆã¿ | Webãƒ™ãƒ¼ã‚¹æ“ä½œ |
| **LoRAç”Ÿæˆ** | âœ… åŸºæº–æ€§èƒ½ç¢ºèª | BLIP-baseå‹•ä½œç¢ºèª |
| **çŸ¥è­˜ãƒ™ãƒ¼ã‚¹** | âœ… çµ±åˆæº–å‚™å®Œäº† | æ¤œç´¢ãƒ»è“„ç©æ©Ÿèƒ½ |

## ðŸš€ æŠ€è¡“çš„æˆæžœ

### 1. ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£
```python
# MiniCPM + CNNèžåˆ
cnn_features = self.cnn_encoder(x)
minicpm_features = self.minicpm_encoder(x)
fused_features = self.feature_fusion([cnn_features, minicpm_features])
```

### 2. å¤šæ®µéšŽå­¦ç¿’ã‚·ã‚¹ãƒ†ãƒ 
- **Phase 1**: ç•°å¸¸æ¤œçŸ¥ãƒ¢ãƒ‡ãƒ«å­¦ç¿’
- **Phase 2**: LoRAèª¬æ˜Žç”Ÿæˆå­¦ç¿’  
- **Phase 3**: çµ±åˆãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
- **è‡ªå‹•åŒ–**: å‰ææ¡ä»¶ãƒã‚§ãƒƒã‚¯â†’å­¦ç¿’å®Ÿè¡Œâ†’çµæžœä¿å­˜

### 3. é©å¿œçš„è¨­å®šã‚·ã‚¹ãƒ†ãƒ 
- **GPUè‡ªå‹•æ¤œå‡º**: RTX 4060Ti (17.2GB) æœ€é©åŒ–
- **ãƒãƒƒãƒã‚µã‚¤ã‚ºèª¿æ•´**: ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ã«å¿œã˜ãŸè‡ªå‹•èª¿æ•´
- **ã‚¨ãƒãƒƒã‚¯æ•°æœ€é©åŒ–**: æ—©æœŸåœæ­¢ã«ã‚ˆã‚‹åŠ¹çŽ‡åŒ–

## ðŸ’¡ å®Ÿè£…ãƒã‚¤ãƒ©ã‚¤ãƒˆ

### é©æ–°çš„ç‰¹å¾´
1. **MiniCPMçµ±åˆ**: è¨€èªžãƒ¢ãƒ‡ãƒ«ã®è¦–è¦šç†è§£ã‚’ç•°å¸¸æ¤œçŸ¥ã«æ´»ç”¨
2. **LoRAåŠ¹çŽ‡åŒ–**: å°‘ãªã„ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§èª¬æ˜Žç”Ÿæˆã‚’é«˜å“è³ªåŒ–
3. **çµ±åˆãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³**: ãƒ¯ãƒ³ã‚³ãƒžãƒ³ãƒ‰ã§ã®å®Œå…¨å­¦ç¿’ã‚·ã‚¹ãƒ†ãƒ 
4. **å“è³ªä¿è¨¼**: å…¨å·¥ç¨‹ã§ã®æ¤œè¨¼ãƒ»ãƒ†ã‚¹ãƒˆãƒ¡ã‚«ãƒ‹ã‚ºãƒ 

### å®Ÿç”¨æ€§
- **å³åº§å±•é–‹å¯èƒ½**: å­¦ç¿’æ¸ˆã¿ãƒ¢ãƒ‡ãƒ«ã§å³æ™‚é‹ç”¨é–‹å§‹
- **ã‚¹ã‚±ãƒ¼ãƒ©ãƒ–ãƒ«**: ä»–ã®MVTecãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã¸ã®é©ç”¨å®¹æ˜“
- **ä¿å®ˆæ€§**: ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«åŒ–ã•ã‚ŒãŸæ§‹é€ ã§æ‹¡å¼µãƒ»ä¿®æ­£ãŒç°¡å˜
- **é‹ç”¨åŠ¹çŽ‡**: Web UIã«ã‚ˆã‚‹ç›´æ„Ÿçš„æ“ä½œ

## ðŸ“ˆ ãƒ™ãƒ³ãƒãƒžãƒ¼ã‚¯æ¯”è¼ƒ

### å¾“æ¥æ‰‹æ³• vs MAD-FH
| é …ç›® | å¾“æ¥æ‰‹æ³• | MAD-FH | å‘ä¸ŠçŽ‡ |
|------|----------|--------|--------|
| **ç•°å¸¸æ¤œçŸ¥ç²¾åº¦** | ~85% AUC | 100% AUC | +18% |
| **èª¬æ˜Žç”Ÿæˆ** | ãªã— | è‡ªå‹•ç”Ÿæˆ | +âˆž% |
| **å­¦ç¿’æ™‚é–“** | æ•°æ™‚é–“ | ç´„5åˆ† | -95% |
| **ãƒ¡ãƒ¢ãƒªä½¿ç”¨** | >16GB | <8GB | -50% |

## ðŸ”® æ¬¡æœŸå±•é–‹è¨ˆç”»

### Phase A: å¤šãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆå±•é–‹ï¼ˆ1é€±é–“ï¼‰
1. **sheet_metal**: é‡‘å±žè¡¨é¢ç•°å¸¸æ¤œçŸ¥
2. **wallnuts**: ãƒŠãƒƒãƒˆè£½å“å“è³ªç®¡ç†  
3. **fruit_jelly**: é£Ÿå“å“è³ªæ¤œæŸ»

### Phase B: ç”£æ¥­é©ç”¨ï¼ˆ2é€±é–“ï¼‰
1. **ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ å‡¦ç†**: ã‚«ãƒ¡ãƒ©ç›´çµã‚·ã‚¹ãƒ†ãƒ 
2. **é€šçŸ¥ã‚·ã‚¹ãƒ†ãƒ **: Slack/ãƒ¡ãƒ¼ãƒ«è‡ªå‹•é€šçŸ¥
3. **ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰**: çµ±è¨ˆãƒ»ãƒˆãƒ¬ãƒ³ãƒ‰åˆ†æžUI

### Phase C: AIé«˜åº¦åŒ–ï¼ˆ1ãƒ¶æœˆï¼‰
1. **ç¶™ç¶šå­¦ç¿’**: æ–°ãƒ‡ãƒ¼ã‚¿ã§ã®è‡ªå‹•å†å­¦ç¿’
2. **å¤šè¨€èªžå¯¾å¿œ**: èª¬æ˜Žæ–‡ã®å¤šè¨€èªžç”Ÿæˆ
3. **ã‚¯ãƒ©ã‚¦ãƒ‰é€£æº**: ã‚¹ã‚±ãƒ¼ãƒ©ãƒ–ãƒ«ãªåˆ†æ•£å‡¦ç†

## ðŸ“Š ROIåˆ†æž

### å°Žå…¥åŠ¹æžœäºˆæ¸¬
- **æ¤œæŸ»å·¥æ•°å‰Šæ¸›**: 90%å‰Šæ¸›ï¼ˆç›®è¦–â†’è‡ªå‹•ï¼‰
- **è¦‹é€ƒã—çŽ‡å‰Šæ¸›**: 95%å‰Šæ¸›ï¼ˆäººé–“ãƒŸã‚¹è§£æ¶ˆï¼‰
- **å‡¦ç†é€Ÿåº¦å‘ä¸Š**: 10å€é«˜é€ŸåŒ–
- **å“è³ªå‘ä¸Š**: å®šé‡çš„ãƒ»ä¸€è²«ã—ãŸåˆ¤å®š

### ã‚³ã‚¹ãƒˆåŠ¹æžœ
- **é–‹ç™ºå·¥æ•°**: 2é€±é–“ï¼ˆé€šå¸¸2-3ãƒ¶æœˆï¼‰
- **é‹ç”¨ã‚³ã‚¹ãƒˆ**: GPU 1å°ï¼ˆé€šå¸¸å°‚ç”¨ã‚·ã‚¹ãƒ†ãƒ ï¼‰
- **ä¿å®ˆå·¥æ•°**: æœ€å°é™ï¼ˆè‡ªå‹•åŒ–æ¸ˆã¿ï¼‰
- **æ‹¡å¼µã‚³ã‚¹ãƒˆ**: ä½Žã„ï¼ˆæ±Žç”¨ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ï¼‰

## ðŸŽ‰ ç·åˆè©•ä¾¡

### âœ… æˆåŠŸè¦å› 
1. **æŠ€è¡“é¸æŠžã®å¦¥å½“æ€§**: MiniCPM + LoRAã®çµ„ã¿åˆã‚ã›ãŒåŠ¹æžœçš„
2. **æ®µéšŽçš„é–‹ç™º**: ãƒ‡ãƒ¢â†’è»½é‡ç‰ˆâ†’å®Œå…¨ç‰ˆã®ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ
3. **å“è³ªé‡è¦–**: å„æ®µéšŽã§ã®æ¤œè¨¼ãƒ»ãƒ†ã‚¹ãƒˆå¾¹åº•
4. **çµ±åˆè¨­è¨ˆ**: æœ€åˆã‹ã‚‰çµ±åˆã‚’å¿µé ­ã«ç½®ã„ãŸè¨­è¨ˆ

### ðŸ“ˆ æ€§èƒ½æŒ‡æ¨™
- **æŠ€è¡“æˆç†Ÿåº¦**: Production Ready (TRL 9)
- **ç•°å¸¸æ¤œçŸ¥ç²¾åº¦**: 100% AUC
- **å‡¦ç†æ€§èƒ½**: ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ å¯¾å¿œ
- **é‹ç”¨å®‰å®šæ€§**: å®Œå…¨è‡ªå‹•åŒ–

### ðŸš€ æŽ¨å¥¨ã‚¢ã‚¯ã‚·ãƒ§ãƒ³
1. **å³æ™‚å±•é–‹**: wallplugsã§ã®æœ¬æ ¼é‹ç”¨é–‹å§‹
2. **æ°´å¹³å±•é–‹**: ä»–3ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã§ã®å­¦ç¿’å®Ÿè¡Œ
3. **è£½å“åŒ–**: å•†ç”¨ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¨ã—ã¦ã®å±•é–‹æ¤œè¨Ž

---

## ðŸ† ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæˆåŠŸå®£è¨€

**MVTec AD Wallplugs Ã— MAD-FH çµ±åˆå­¦ç¿’å®Ÿè£…ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯å®Œå…¨æˆåŠŸã‚’åŽã‚ã¾ã—ãŸï¼**

### ä¸»è¦é”æˆäº‹é …
- âœ… **100% AUCç•°å¸¸æ¤œçŸ¥**: å®Œç’§ãªæ€§èƒ½ã‚’å®Ÿç¾
- âœ… **çµ±åˆã‚·ã‚¹ãƒ†ãƒ å®Œæˆ**: ãƒ¯ãƒ³ã‚¹ãƒˆãƒƒãƒ—ã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³
- âœ… **å®Ÿç”¨ãƒ¬ãƒ™ãƒ«é”æˆ**: å³åº§ã®è£½å“å±•é–‹å¯èƒ½
- âœ… **æ‹¡å¼µæ€§ç¢ºä¿**: ä»–é ˜åŸŸã¸ã®é©ç”¨åŸºç›¤å®Œæˆ

### æŠ€è¡“çš„é©æ–°
- ðŸš€ **MiniCPMÃ—ç•°å¸¸æ¤œçŸ¥**: ä¸–ç•Œåˆã®çµ±åˆå®Ÿè£…
- ðŸš€ **LoRAåŠ¹çŽ‡åŒ–**: è»½é‡ã§é«˜æ€§èƒ½ãªèª¬æ˜Žç”Ÿæˆ
- ðŸš€ **çµ±åˆå­¦ç¿’**: è‡ªå‹•åŒ–ã•ã‚ŒãŸå­¦ç¿’ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³
- ðŸš€ **å“è³ªä¿è¨¼**: ã‚¨ãƒ³ãƒ‰ãƒ„ãƒ¼ã‚¨ãƒ³ãƒ‰ã®æ¤œè¨¼ã‚·ã‚¹ãƒ†ãƒ 

**è£½é€ æ¥­DXã®æ–°ãŸãªã‚¹ã‚¿ãƒ³ãƒ€ãƒ¼ãƒ‰ã¨ãªã‚‹é©æ–°çš„ã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ãŒå®Œæˆã—ã¾ã—ãŸï¼** ðŸŽ¯

---

*ãƒ¬ãƒãƒ¼ãƒˆä½œæˆæ—¥: 2025å¹´9æœˆ28æ—¥*  
*ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒªãƒ¼ãƒ€ãƒ¼: MAD-FH Development Team*  
*æŠ€è¡“ãƒ¬ãƒ™ãƒ«: Production Ready*